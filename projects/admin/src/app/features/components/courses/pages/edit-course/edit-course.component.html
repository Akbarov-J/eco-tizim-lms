<div class="max-w-[900px]! m-6 xl:mx-auto p-5 rounded-2xl bg-white flex flex-col">
  <a routerLink="/admin/courses"
    class="self-start flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-gray-100 transition-all duration-300 mb-5 w-auto">
    <span class="pi pi-arrow-left"></span>
    <p class="text-lg">Назад</p>
  </a>

  <form [formGroup]="courseForm" (ngSubmit)="onSubmit()" class="space-y-6">

    <!-- Изображение -->
    <div class="space-y-2">
      <label class="block text-sm font-semibold text-gray-700">
        Изображение курса
      </label>

      <div class="flex flex-col items-start">
        <!-- Превью -->
        <div *ngIf="previewUrl" class="mb-3">
          <img [src]="previewUrl" alt="Preview" class="w-40 h-40 object-cover rounded-xl border shadow-sm" />
        </div>

        <!-- Кнопка загрузки/изменения -->
        <button type="button" (click)="fileInput.click()"
          class="flex items-center gap-2 rounded-xl bg-blue-500 py-2 px-4 text-white hover:bg-blue-600 transition-all shadow-sm">
          <span class="pi pi-upload"></span>
          {{ previewUrl ? 'Изменить изображение' : 'Загрузить изображение' }}
        </button>

        <!-- Скрытое поле выбора файла -->
        <input #fileInput id="image" type="file" (change)="onFileSelected($event)" accept="image/*" class="hidden" />
      </div>
    </div>

    <!-- Название курса -->
    <div class="space-y-2">
      <label for="title" class="block text-sm font-semibold text-gray-700">
        Название курса <span class="text-red-500">*</span>
      </label>
      <input id="title" pInputText type="text" formControlName="title" placeholder="Введите название курса"
        class="w-full" [class]="getInputClasses('title')" />
      @if(courseForm.get('title')?.invalid && courseForm.get('title')?.touched){
      <div class="text-red-500 text-xs mt-1">
        Название курса обязательно для заполнения
      </div>
      }
    </div>

    <!-- Описание курса -->
    <div class="space-y-2">
      <label for="description" class="block text-sm font-semibold text-gray-700">
        Описание курса <span class="text-red-500">*</span>
      </label>
      <textarea id="description" pInputTextarea formControlName="description" placeholder="Введите описание курса"
        rows="4" class="w-full resize-none transition-colors duration-200" [class]="getInputClasses('description')">
      </textarea>
      @if(courseForm.get('description')?.invalid && courseForm.get('description')?.touched){
      <div class="text-red-500 text-xs mt-1">
        Описание курса обязательно для заполнения
      </div>
      }
    </div>

    <!-- Язык курса -->
    <div class="space-y-2">
      <label for="languageCode" class="block text-sm font-semibold text-gray-700">
        Язык курса <span class="text-red-500">*</span>
      </label>
      <p-select id="languageCode" [options]="languageOptions" formControlName="languageCode"
        placeholder="Выберите язык курса" optionLabel="label" optionValue="value" class="w-full">
      </p-select>
      @if(courseForm.get('languageCode')?.invalid && courseForm.get('languageCode')?.touched){
      <div class="text-red-500 text-xs mt-1">
        Язык курса обязателен для выбора
      </div>
      }
    </div>

    <!-- Автор курса -->
    <div class="space-y-2">
      <label for="authorId" class="block text-sm font-semibold text-gray-700">
        Автор курса <span class="text-red-500">*</span>
      </label>
      <p-select id="authorId" [options]="authorOptions" formControlName="authorId" placeholder="Выберите автора курса"
        optionLabel="label" optionValue="value" [filter]="true" filterPlaceholder="Поиск автора..." class="w-full">
      </p-select>
      @if(courseForm.get('authorId')?.invalid && courseForm.get('authorId')?.touched){
      <div class="text-red-500 text-xs mt-1">
        Автор курса обязателен для выбора
      </div>
      }
    </div>

    <!-- Категория курса -->
    <div class="space-y-2">
      <label for="categoryId" class="block text-sm font-semibold text-gray-700">
        Категория курса <span class="text-red-500">*</span>
      </label>
      <p-select id="categoryId" [options]="categoryOptions" formControlName="categoryId"
        placeholder="Выберите категорию курса" optionLabel="label" optionValue="value" [filter]="true"
        filterPlaceholder="Поиск категории..." class="w-full">
      </p-select>
      @if(courseForm.get('categoryId')?.invalid && courseForm.get('categoryId')?.touched){
      <div class="text-red-500 text-xs mt-1">
        Категория курса обязательна для выбора
      </div>
      }
    </div>

    <!-- Статус -->
    <div class="space-y-2">
      <label for="status" class="block text-sm font-semibold text-gray-700">
        Статус <span class="text-red-500">*</span>
      </label>
      <p-select id="status" [options]="statusOptions" formControlName="status" placeholder="Выберите статус"
        optionLabel="label" optionValue="value" class="w-full">
      </p-select>
    </div>

    <!-- Кнопки -->
    <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">
      <a routerLink="/admin/courses"
        class="flex items-center gap-2 rounded-2xl bg-gray-500 py-3 px-4 hover:shadow-lg cursor-pointer">
        <span class="pi pi-times text-white"></span>
        <p class="text-white font-semibold">Отмена</p>
      </a>
      <button type="submit" [disabled]="courseForm.invalid"
        class="flex items-center gap-2 rounded-2xl bg-blue-500 py-3 px-4 hover:shadow-lg cursor-pointer disabled:bg-gray-400 disabled:cursor-not-allowed">
        <span class="pi pi-check text-white"></span>
        <p class="text-white font-semibold">Сохранить</p>
      </button>
    </div>
  </form>
</div>

<p-toast></p-toast>